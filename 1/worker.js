function randomInt(e){return Math.floor(Math.random()*e)}let bpe=0,mask=0,radix=mask+1;const digitsStr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(bpe=0;1<<bpe+1>1<<bpe;bpe++);radix=(mask=(1<<(bpe>>=1))-1)+1;let one=int2bigInt(1,1,1);function int2bigInt(e,t,r){var n;n=r>(n=Math.ceil(t/bpe)+1)?r:n;var g=new Array(n);return copyInt_(g,e),g}function copy_(e,t){var r,n=e.length<t.length?e.length:t.length;for(r=0;r<n;r++)e[r]=t[r];for(r=n;r<e.length;r++)e[r]=0}function copyInt_(e,t){var r,n;for(n=t,r=0;r<e.length;r++)e[r]=n&mask,n>>=bpe}function multInt_(e,t){var r,n,g,a;if(t)for(n=e.length,g=0,r=0;r<n;r++)a=0,(g+=e[r]*t)<0&&(g+=(a=-(g>>bpe))*radix),e[r]=g&mask,g=(g>>bpe)-a}function addInt_(e,t){var r,n,g,a;for(e[0]+=t,n=e.length,g=0,r=0;r<n;r++)if(a=0,(g+=e[r])<0&&(g+=(a=-(g>>bpe))*radix),e[r]=g&mask,!(g=(g>>bpe)-a))return}function str2bigInt(e,t,r){var n,g,a,o,_,f=e.length;if(-1==t){for(a=new Array(0);;){for(o=new Array(a.length+1),g=0;g<a.length;g++)o[g+1]=a[g];if(o[0]=parseInt(e,10),a=o,(n=e.indexOf(",",0))<1)break;if(0==(e=e.substring(n+1)).length)break}return a.length<r?(copy_(o=new Array(r),a),o):a}for(a=int2bigInt(0,t*f,0),g=0;g<f&&(n=digitsStr.indexOf(e.substring(g,g+1),0),t<=36&&n>=36&&(n-=26),!(n>=t||n<0));g++)multInt_(a,t),addInt_(a,n);for(f=a.length;f>0&&!a[f-1];f--);for(f=r>f+1?r:f+1,o=new Array(f),_=f<a.length?f:a.length,g=0;g<_;g++)o[g]=a[g];for(;g<f;g++)o[g]=0;return o}function bigInt2str(e,t){var r,n,g="";if(s6.length!=e.length?s6=dup(e):copy_(s6,e),-1==t){for(r=e.length-1;r>0;r--)g+=e[r]+",";g+=e[0]}else for(;!isZero(s6);)n=divInt_(s6,t),g=digitsStr.substring(n,n+1)+g;return 0==g.length&&(g="0"),g}function isZero(e){var t;for(t=0;t<e.length;t++)if(e[t])return 0;return 1}function add_(e,t){var r,n,g;for(g=e.length<t.length?e.length:t.length,n=0,r=0;r<g;r++)n+=e[r]+t[r],e[r]=n&mask,n>>=bpe;for(r=g;n&&r<e.length;r++)n+=e[r],e[r]=n&mask,n>>=bpe}function greater(e,t){var r,n=e.length<t.length?e.length:t.length;for(r=e.length;r<t.length;r++)if(t[r])return 0;for(r=t.length;r<e.length;r++)if(e[r])return 1;for(r=n-1;r>=0;r--){if(e[r]>t[r])return 1;if(e[r]<t[r])return 0}return 0}function rightShift_(e,t){var r,n=Math.floor(t/bpe);if(n){for(r=0;r<e.length-n;r++)e[r]=e[r+n];for(;r<e.length;r++)e[r]=0;t%=bpe}for(r=0;r<e.length-1;r++)e[r]=mask&(e[r+1]<<bpe-t|e[r]>>t);e[r]>>=t}function sub_(e,t){var r,n,g;for(g=e.length<t.length?e.length:t.length,n=0,r=0;r<g;r++)n+=e[r]-t[r],e[r]=n&mask,n>>=bpe;for(r=g;n&&r<e.length;r++)n+=e[r],e[r]=n&mask,n>>=bpe}function halve_(e){var t;for(t=0;t<e.length-1;t++)e[t]=mask&(e[t+1]<<bpe-1|e[t]>>1);e[t]=e[t]>>1|e[t]&radix>>1}function equalsInt(e,t){var r;if(e[0]!=t)return 0;for(r=1;r<e.length;r++)if(e[r])return 0;return 1}function negative(e){return e[e.length-1]>>bpe-1&1}function leftShift_(e,t){var r,n=Math.floor(t/bpe);if(n){for(r=e.length;r>=n;r--)e[r]=e[r-n];for(;r>=0;r--)e[r]=0;t%=bpe}if(t){for(r=e.length-1;r>0;r--)e[r]=mask&(e[r]<<t|e[r-1]>>bpe-t);e[r]=mask&e[r]<<t}}function divide_(e,t,r,n){var g,a,o,_,f,h,i,l;for(copy_(n,e),a=t.length;0==t[a-1];a--);for(l=t[a-1],i=0;l;i++)l>>=1;for(leftShift_(t,i=bpe-i),leftShift_(n,i),g=n.length;0==n[g-1]&&g>a;g--);for(copyInt_(r,0);!greaterShift(t,n,g-a);)subShift_(n,t,g-a),r[g-a]++;for(o=g-1;o>=a;o--){for(n[o]==t[a-1]?r[o-a]=mask:r[o-a]=Math.floor((n[o]*radix+n[o-1])/t[a-1]);h=(f=(a>1?t[a-2]:0)*r[o-a])>>bpe,f&=mask,h=(_=h+r[o-a]*t[a-1])>>bpe,_&=mask,h==n[o]?_==n[o-1]?f>(o>1?n[o-2]:0):_>n[o-1]:h>n[o];)r[o-a]--;linCombShift_(n,t,-r[o-a],o-a),negative(n)&&(addShift_(n,t,o-a),r[o-a]--)}rightShift_(t,i),rightShift_(n,i)}function greaterShift(e,t,r){var n,g=e.length,a=t.length,o=g+r<a?g+r:a;for(n=a-1-r;n<g&&n>=0;n++)if(e[n]>0)return 1;for(n=g-1+r;n<a;n++)if(t[n]>0)return 0;for(n=o-1;n>=r;n--){if(e[n-r]>t[n])return 1;if(e[n-r]<t[n])return 0}return 0}function subShift_(e,t,r){var n,g,a,o;for(a=e.length<r+t.length?e.length:r+t.length,o=e.length,g=0,n=r;n<a;n++)g+=e[n]-t[n-r],e[n]=g&mask,g>>=bpe;for(n=a;g&&n<o;n++)g+=e[n],e[n]=g&mask,g>>=bpe}function linCombShift_(e,t,r,n){var g,a,o,_;for(o=e.length<n+t.length?e.length:n+t.length,_=e.length,a=0,g=n;g<o;g++)a+=e[g]+r*t[g-n],e[g]=a&mask,a>>=bpe;for(g=o;a&&g<_;g++)a+=e[g],e[g]=a&mask,a>>=bpe}let t=new Array(0),eg_u=t,eg_A=t,eg_B=t,eg_C=t,eg_D=t,s6=t;function eGCD_(e,t,r,n,g){var a=0,o=Math.max(e.length,t.length);for(eg_u.length!=o&&(eg_u=new Array(o),eg_A=new Array(o),eg_B=new Array(o),eg_C=new Array(o),eg_D=new Array(o));!(1&e[0]||1&t[0]);)halve_(e),halve_(t),a++;for(copy_(eg_u,e),copy_(r,t),copyInt_(eg_A,1),copyInt_(eg_B,0),copyInt_(eg_C,0),copyInt_(eg_D,1);;){for(;!(1&eg_u[0]);)halve_(eg_u),1&eg_A[0]||1&eg_B[0]?(add_(eg_A,t),halve_(eg_A),sub_(eg_B,e),halve_(eg_B)):(halve_(eg_A),halve_(eg_B));for(;!(1&r[0]);)halve_(r),1&eg_C[0]||1&eg_D[0]?(add_(eg_C,t),halve_(eg_C),sub_(eg_D,e),halve_(eg_D)):(halve_(eg_C),halve_(eg_D));if(greater(r,eg_u)?(sub_(r,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,r),sub_(eg_A,eg_C),sub_(eg_B,eg_D)),equalsInt(eg_u,0)){for(;negative(eg_C);)add_(eg_C,t),sub_(eg_D,e);return multInt_(eg_D,-1),copy_(n,eg_C),copy_(g,eg_D),void leftShift_(r,a)}}}function dup(e){var t=new Array(e.length);return copy_(t,e),t}function divInt_(e,t){var r,n,g=0;for(r=e.length-1;r>=0;r--)n=g*radix+e[r],e[r]=Math.floor(n/t),g=n%t;return g}function factorLeemon(e){what=str2bigInt(e,16,Math.ceil(64/bpe)+1);var t,r,n,g,a,o,_=Math.ceil(64/bpe)+1,f=0,h=new Array(_),i=new Array(_),l=new Array(_),u=new Array(_),s=new Array(_),b=new Array(_),p=new Array(_);for(t=0;t<3;t++){for(r=17+(15&randomInt(128)),copyInt_(b,randomInt(1e9)+1),copy_(p,b),g=1<<t+18,n=1;n<g;n++){for(++f,copy_(h,b),copy_(i,b),copyInt_(l,r);!isZero(i);)1&i[0]&&(add_(l,h),greater(l,what)&&sub_(l,what)),add_(h,h),greater(h,what)&&sub_(h,what),rightShift_(i,1);if(copy_(b,l),greater(b,p)?(copy_(s,b),sub_(s,p)):(copy_(s,p),sub_(s,b)),eGCD_(s,what,u,h,i),!equalsInt(u,1))break;0==(n&n-1)&&copy_(p,b)}if(greater(u,one))break}return divide_(what,u,b,p),greater(u,b)?(a=b,o=u):(a=u,o=b),[bigInt2str(a,16),bigInt2str(o,16),f]}onmessage=async e=>{console.log("worker received request for ",e.data.n);try{let[t,r,n]=factorLeemon(e.data.n);postMessage({n:e.data.n,p:t,q:r,it:n})}catch(e){console.log("Leemon error: ",e)}};
